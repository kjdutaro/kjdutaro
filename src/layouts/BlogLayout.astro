---
/**
 * BlogLayout — wraps individual blog post pages with pixel design.
 * Article metadata, prose styling, and share links.
 */
import BaseLayout from "./BaseLayout.astro";
import type { CollectionEntry } from "astro:content";
import profile from "../data/profile";

interface Props {
  entry: CollectionEntry<"blog">;
}

const { entry } = Astro.props;
const { title, description, date, tags = [] } = entry.data;

const schemaMarkup = {
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  headline: title,
  description,
  datePublished: date.toISOString(),
  dateModified: date.toISOString(),
  author: {
    "@type": "Person",
    name: profile.name,
  },
  keywords: tags.join(", "),
};
---

<BaseLayout
  title={`${title} – Blog`}
  description={description}
  canonical={`/blog/${entry.slug}`}
  keywords="web development blog, WordPress tips, tourism site development, SEO for tourism"
>
  <script
    type="application/ld+json"
    set:html={JSON.stringify(schemaMarkup)}
  />
  <article class="c-section">
    <div class="c-container max-w-3xl">
      <!-- Post header -->
      <div class="mb-8 pb-6 border-b-2 border-[var(--border-default)]">
        <p class="c-section-eyebrow">Blog Post</p>
        <h1
          class="font-heading text-2xl md:text-3xl lg:text-4xl font-bold mb-4 text-[var(--text-primary)]"
        >
          {title}
        </h1>
        <p class="font-mono text-xs text-[var(--text-muted)]">
          {
            new Date(date).toLocaleDateString("en-US", {
              year: "numeric",
              month: "long",
              day: "numeric",
            })
          }
        </p>

        {
          tags.length > 0 && (
            <div class="flex flex-wrap gap-2 mt-4">
              {tags.map((tag) => (
                <a
                  href={`/blog?tag=${tag}`}
                  class="font-mono text-xs bg-[var(--bg-elevated)] text-[var(--text-muted)] px-2.5 py-0.5 border border-[var(--border-default)] hover:bg-[var(--accent-muted)] hover:text-[var(--accent)] hover:border-[var(--accent)] transition-colors no-underline"
                >
                  #{tag}
                </a>
              ))}
            </div>
          )
        }
      </div>

      <!-- Post content -->
      <div class="prose max-w-none">
        <slot />
      </div>

      <!-- Share links -->
      <div class="mt-12 pt-8 border-t-2 border-[var(--border-default)]">
        <p class="font-heading text-sm text-[var(--text-muted)] mb-4">
          Enjoyed this post? Share it with your network!
        </p>
        <div class="flex gap-3">
          <a
            href={`https://twitter.com/intent/tweet?text=${encodeURIComponent(title)}&url=${encodeURIComponent(new URL(`/blog/${entry.slug}`, Astro.site).toString())}`}
            target="_blank"
            rel="noopener noreferrer"
            class="c-btn c-btn-ghost text-xs h-9 px-4"
          >
            Share on Twitter
          </a>
          <a
            href={`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(new URL(`/blog/${entry.slug}`, Astro.site).toString())}`}
            target="_blank"
            rel="noopener noreferrer"
            class="c-btn c-btn-ghost text-xs h-9 px-4"
          >
            Share on LinkedIn
          </a>
        </div>
      </div>
    </div>
  </article>
</BaseLayout>
