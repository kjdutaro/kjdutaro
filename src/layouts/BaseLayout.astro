---
/**
 * BaseLayout — root HTML shell shared by all pages.
 * Provides <head> metadata, theme init (flash-free), Header and Footer.
 * All personal data comes from src/data/profile.ts (single source of truth).
 */
import "../styles/global.css";
import Header from "../components/layout/Header.astro";
import Footer from "../components/layout/Footer.astro";
import { ClientRouter } from "astro:transitions";
import profile from "../data/profile";

const {
  title,
  description = profile.seo.defaultDescription,
  keywords = profile.seo.defaultKeywords,
  ogImage = profile.seo.defaultOgImage,
  canonical = Astro.url.pathname,
} = Astro.props;

const defaultKeywords =
  "Kristee Joy Dutaro, frontend developer, React developer, JavaScript developer, Chrome extension developer, touring microsites, map API integration, remote developer Philippines";
const metaKeywords = keywords ?? defaultKeywords;

/* JSON-LD structured data for Person / Website / Professional Service — Enhanced for SEO */
const schemaMarkup = [
  {
    "@context": "https://schema.org",
    "@type": "Person",
    name: profile.name,
    alternateName: profile.fullName,
    url: profile.siteUrl,
    image: new URL(ogImage, Astro.site).toString(),
    jobTitle: profile.title,
    description: description,
    email: profile.contact.email,
    telephone: profile.contact.phone,
    sameAs: [profile.social.github, profile.social.linkedin],
    knowsAbout: profile.knowsAbout,
    address: {
      "@type": "PostalAddress",
      ...profile.structuredData.person.address,
    },
    areaServed: {
      "@type": "Place",
      name: "Worldwide",
    },
    workLocation: {
      "@type": "Place",
      name: "Remote",
    },
    alumniOf: {
      "@type": "EducationalOrganization",
      ...profile.structuredData.person.alumniOf,
    },
    hasCredential: profile.structuredData.person.hasCredential.map((cred: { name: string; credentialCategory: string }) => ({
      "@type": "EducationalOccupationalCredential",
      ...cred,
    })),
  },
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    name: `${profile.name}`,
    alternateName: `${profile.fullName} Portfolio`,
    url: profile.siteUrl,
    description: description,
    inLanguage: "en-US",
    isPartOf: {
      "@type": "WebSite",
      name: profile.siteUrl,
      url: profile.siteUrl,
    },
    potentialAction: {
      "@type": "SearchAction",
      target: {
        "@type": "EntryPoint",
        urlTemplate: `${profile.siteUrl}/search?q={search_term_string}`,
      },
      "query-input": "required name=search_term_string",
    },
  },
  {
    "@context": "https://schema.org",
    "@type": "ProfessionalService",
    name: `${profile.name} - Web Development Services`,
    alternateName: `${profile.fullName} Web Development`,
    url: profile.siteUrl,
    description: "Frontend / Web Development services specializing in React, JavaScript, touring microsites, Chrome extensions, and modern web technologies.",
    areaServed: "Worldwide",
    availableLanguage: ["English"],
    serviceType: [
      "Web Development",
      "Frontend Development",
      "WordPress Theme Development",
      "Chrome Extension Development",
      "Website Maintenance",
      "Localization Services",
    ],
    provider: {
      "@type": "Person",
      name: profile.name,
      alternateName: profile.fullName,
    },
    contactPoint: {
      "@type": "ContactPoint",
      email: profile.contact.email,
      telephone: profile.contact.phone,
      availableLanguage: ["English"],
      contactType: "professional services",
    },
  },
];
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="keywords" content={metaKeywords} />
    <meta name="author" content={profile.name} />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <meta name="googlebot" content="index, follow" />
    <meta name="bingbot" content="index, follow" />
    
    <!-- Language and revisit settings -->
    <meta name="language" content="English" />
    <meta name="revisit-after" content="7 days" />
    <meta name="rating" content="general" />
    
    <!-- Performance: DNS prefetch for external resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    
    <!-- Geo + international audience -->
    <meta name="geo.region" content="PH" />
    <meta name="geo.placename" content="Philippines" />
    <meta property="og:locale" content="en_US" />

    <!-- Canonical URL -->
    <link rel="canonical" href={new URL(canonical, Astro.site)} />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content={profile.name} />
    <meta property="og:url" content={new URL(canonical, Astro.site)} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={new URL(ogImage, Astro.site)} />
    <meta property="og:image:alt" content={`${profile.name} - ${profile.title}`} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />

    <!-- JSON-LD Schema -->
    <script
      type="application/ld+json"
      set:html={JSON.stringify(schemaMarkup)}
    />

    <!-- Comprehensive Favicon -->
    <link rel="icon" type="image/x-icon" href="/icons/favicon.ico" />
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/icon16.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon32.png" />
    <link rel="icon" type="image/png" sizes="48x48" href="/icons/icon48.png" />
    <link rel="icon" type="image/png" sizes="64x64" href="/icons/icon64.png" />
    <link rel="icon" type="image/png" sizes="128x128" href="/icons/icon128.png" />
    
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />
    
    <!-- Android Chrome -->
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-chrome.png" />
    <meta name="theme-color" content="#0a0a0b" />
    
    <!-- Microsoft Tile -->
    <meta name="msapplication-TileColor" content="#0a0a0b" />
    <meta name="msapplication-TileImage" content="/icons/icon144.png" />
    
    <!-- Humans.txt & LLMs.txt -->
    <link rel="author" href="/humans.txt" />
    <link rel="alternate" type="text/plain" href="/llms.txt" title="LLM-friendly site info" />

    <!-- View Transitions for smooth page navigation -->
    <ClientRouter />
  </head>

  <body
    class="bg-[var(--bg-primary)] text-[var(--text-primary)] flex flex-col min-h-screen"
  >
    <Header />
    <main class="flex-1" id="main-content">
      <slot />
    </main>
    <Footer />
  </body>
</html>
