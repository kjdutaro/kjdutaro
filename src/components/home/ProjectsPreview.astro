---
/**
 * ProjectsPreview â€” featured projects on the homepage with pixel design.
 * Shows up to 4 featured projects. Falls back to most recent 4.
 */
import { getCollection } from "astro:content";
import ProjectCard from "../ui/ProjectCard.astro";

const projects = await getCollection("projects");
const featured = projects.filter((p) => p.data.featured).slice(0, 4);
const display = featured.length > 0 ? featured : projects.slice(0, 4);
---

<section id="projects" aria-label="Featured Projects" class="c-section">
  <div class="c-container">
    <p class="c-section-eyebrow">Portfolio</p>

    <div class="flex flex-wrap items-end justify-between gap-4 mb-10">
      <div>
        <h2 class="c-section-title">Featured Work</h2>
        <p class="c-section-desc mb-0">
          A selection of recent projects across static sites, WordPress themes,
          and modern web apps.
        </p>
      </div>
      <a
        href="/projects"
        class="c-link font-mono text-xs text-[var(--accent)] hover:text-[var(--accent-hover)] border border-transparent hover:border-[var(--border-default)] px-3 py-1.5"
      >
        View all projects &rarr;
      </a>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 md:gap-8">
      {
        display.map((project) => (
          <ProjectCard
            title={project.data.title}
            description={project.data.description}
            tech={project.data.tech}
            github={project.data.github}
            liveLink={project.data.liveLink}
            image={project.data.image}
            featured={project.data.featured}
            category={project.data.category}
            href={`/projects/${project.slug}`}
          />
        ))
      }
    </div>
  </div>
</section>
