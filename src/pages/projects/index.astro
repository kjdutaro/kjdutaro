---
/**
 * Projects index — lists all projects with pixel/glitch design.
 */
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import ProjectCard from "../../components/ui/ProjectCard.astro";
import profile from "../../data/profile";

const projects = await getCollection("projects");
const sorted = projects.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime(),
);
const featured = sorted.filter((p) => p.data.featured);
const unfeatured = sorted.filter((p) => !p.data.featured);
---

<BaseLayout
  title={`Projects – ${profile.name}`}
  description="Web development projects: static sites, WordPress themes, and modern web applications."
  canonical="/projects"
>
  <section class="c-section">
    <div class="c-container">
      <p class="c-section-eyebrow">Portfolio</p>
      <h1
        class="font-heading text-3xl md:text-4xl font-bold text-[var(--text-primary)] mb-4"
      >
        Projects
      </h1>
      <p class="text-[var(--text-muted)] max-w-2xl mb-12 leading-relaxed">
        A selection of work across static sites, WordPress themes, and modern
        web apps.
      </p>

      {
        featured.length > 0 && (
          <div class="mb-16">
            <h2 class="font-heading text-xl font-semibold text-[var(--text-primary)] mb-6 flex items-center gap-2">
              <span class="text-[var(--accent)]" aria-hidden="true">&gt;</span>
              Featured
            </h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 md:gap-8">
              {featured.map((project) => (
                <ProjectCard
                  title={project.data.title}
                  description={project.data.description}
                  tech={project.data.tech}
                  github={project.data.github}
                  liveLink={project.data.liveLink}
                  image={project.data.image}
                  featured={project.data.featured}
                  href={`/projects/${project.slug}`}
                />
              ))}
            </div>
          </div>
        )
      }

      {
        unfeatured.length > 0 && (
          <div>
            <h2 class="font-heading text-xl font-semibold text-[var(--text-primary)] mb-6 flex items-center gap-2">
              <span class="text-[var(--accent)]" aria-hidden="true">&gt;</span>
              More work
            </h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 md:gap-8">
              {unfeatured.map((project) => (
                <ProjectCard
                  title={project.data.title}
                  description={project.data.description}
                  tech={project.data.tech}
                  github={project.data.github}
                  liveLink={project.data.liveLink}
                  image={project.data.image}
                  featured={project.data.featured}
                  href={`/projects/${project.slug}`}
                />
              ))}
            </div>
          </div>
        )
      }
    </div>
  </section>
</BaseLayout>
